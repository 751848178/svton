// 本地 scale 函数（1.7倍缩放）
@function scale($size) {
  @return calc($size * 1.7);
}

// 颜色变量
$color-white: #ffffff;
$color-primary: #ff2442;
$color-background: #f5f5f5;
$color-border: #e5e5e5;
$color-text-secondary: #666;
$color-text-tertiary: #999;
$font-size-base: scale(16px);
$font-size-sm: scale(12px);
$font-size-lg: scale(18px);

.content-action-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: $color-white;
  padding: scale(16px) scale(24px);
  padding-bottom: calc(scale(16px) + env(safe-area-inset-bottom));
  box-shadow: 0 scale(-4px) scale(16px) rgba(0, 0, 0, 0.08);
  z-index: 100;
  
  // 收起状态
  .action-bar-collapsed {
    display: flex;
    align-items: center;
    gap: scale(12px);
    
    .input-placeholder {
      flex: 1;
      padding: scale(12px) scale(20px);
      background: $color-background;
      border-radius: scale(48px);
      cursor: pointer;
      transition: background-color 0.2s;
      
      &:active {
        background: #e8e8e8;
      }
      
      .placeholder-text {
        font-size: $font-size-base;
        color: $color-text-tertiary;
      }
    }
    
    .action-buttons {
      display: flex;
      align-items: center;
      gap: scale(16px);
      
      .action-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: scale(48px);
        height: scale(48px);
        cursor: pointer;
        transition: transform 0.2s;
        
        &:active {
          transform: scale(0.9);
        }
        
        .action-icon {
          font-size: scale(28px);
          
          &.liked {
            animation: heartBeat 0.3s;
          }
          
          &.favorited {
            animation: starBeat 0.3s;
          }
        }
        
        .action-icon-img {
          width: scale(26px);
          height: scale(26px);
          
          &.liked {
            animation: heartBeat 0.3s;
          }
          
          &.favorited {
            animation: starBeat 0.3s;
          }
        }
      }
    }
  }
  
  // 展开状态
  .action-bar-expanded {
    display: flex;
    flex-direction: column;
    gap: scale(12px);
    
    .comment-textarea {
      width: 100%;
      box-sizing: border-box;  // ✅ 关键：让 padding 和 border 包含在 width 内
      min-height: scale(80px);
      max-height: scale(200px);
      padding: scale(12px) scale(16px);
      font-size: $font-size-base;
      line-height: 1.6;
      background: $color-background;
      border-radius: scale(8px);
      border: 1px solid $color-border;
      
      &:focus {
        border-color: $color-primary;
      }
    }
    
    .expanded-actions {
      display: flex;
      align-items: center;
      justify-content: space-between;
      
      .char-count {
        font-size: $font-size-sm;
        color: $color-text-tertiary;
      }
      
      .action-btns {
        display: flex;
        gap: scale(12px);
        
        .cancel-btn,
        .send-btn {
          padding: scale(8px) scale(24px);
          border-radius: scale(32px);
          cursor: pointer;
          transition: all 0.2s;
          
          .btn-text {
            font-size: $font-size-base;
          }
          
          &:active {
            transform: scale(0.95);
          }
        }
        
        .cancel-btn {
          background: $color-background;
          
          .btn-text {
            color: $color-text-secondary;
          }
        }
        
        .send-btn {
          background: $color-primary;
          
          .btn-text {
            color: $color-white;
            font-weight: 500;
          }
          
          &.active {
            opacity: 1;
          }
          
          &.disabled {
            opacity: 0.5;
            cursor: not-allowed;
          }
        }
      }
    }
  }
}

// 动画
@keyframes heartBeat {
  0%, 100% {
    transform: scale(1);
  }
  25% {
    transform: scale(1.2);
  }
  50% {
    transform: scale(0.95);
  }
  75% {
    transform: scale(1.1);
  }
}

@keyframes starBeat {
  0%, 100% {
    transform: scale(1) rotate(0deg);
  }
  50% {
    transform: scale(1.3) rotate(15deg);
  }
}
